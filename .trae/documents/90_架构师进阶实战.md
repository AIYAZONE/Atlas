# 架构师进阶实战指南 (Architect's Playbook)

> **文档说明**：本文档为你提供了从 Senior Frontend 转型 Architect 所需的核心工具模板。请在 Atlas 项目中践行这些规范，建立技术影响力。

## 1. 架构决策记录模板 (ADR Template)
**何时使用**：当你面临重大技术选择（如选框架、选库、定目录结构）时，不要只口头讨论，填这个表。

```markdown
# ADR-001: [标题，例如：选择 Nuxt 3 作为前端框架]

## 状态
[草稿 / 已通过 / 已废弃]

## 背景
我们需要一个支持 SSG、SEO 友好且开发效率高的框架来构建 Atlas。团队现有技术栈主要为 Vue 2/3。

## 选项
1. **Nuxt 3** (Vue 3 全家桶)
2. **Shopify Hydrogen** (React / Remix)
3. **Next.js** (React)

## 决策
选择 **Nuxt 3**。

## 理由
1. **团队匹配度**：团队成员精通 Vue，迁移 React 成本过高（预计增加 1 个月学习期）。
2. **生态成熟度**：Nuxt 3 的 Content 模块和 SSG 能力完全满足需求。
3. **解耦**：Hydrogen 与 Shopify 绑定过深，不利于未来去 Shopify 化。

## 后果
*   **正面**：开发速度快，无需重写现有 Vue 组件库。
*   **负面**：无法使用 Shopify 官方的部分 React Hooks，需自行封装 API Client。
```

## 2. 技术债管理看板 (Tech Debt Radar)
**何时使用**：为了进度不得不写烂代码时，记录下来，制定偿还计划。

| 模块 | 技术债描述 | 严重程度 | 产生原因 | 计划偿还时间 | 负责人 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **Builder** | 暂未实现 iframe 样式隔离，可能有样式污染 | High | MVP 赶进度 | Phase 2 | Bruce |
| **Cart** | 购物车状态未做持久化容错，断网可能丢数据 | Medium | 逻辑复杂 | Phase 3 | - |

## 3. 系统可维护性指南 (Maintainability Guide)
**核心原则**：写代码是给别人看的，顺便给机器运行。

### 3.1 目录结构规范
*   `apps/`：只放应用入口，不放通用逻辑。
*   `packages/`：放核心逻辑（Schema、API、Utils），必须 100% 单元测试覆盖。

### 3.2 提交规范 (Commit Convention)
*   `feat`: 新功能
*   `fix`: 修 Bug
*   `refactor`: 重构（不改变逻辑）
*   `docs`: 仅修改文档 (架构师要多提交这个!)

### 3.3 代码审查清单 (Code Review Checklist)
*   [ ] 是否引入了新的 npm 包？（严控包体积）
*   [ ] 是否有 TypeScript `any` 类型？（严禁 `any`）
*   [ ] 核心逻辑是否有注释说明“为什么这么做”？

## 4. 经典战役复盘：Vue vs React (The Framework War)
**如何做一个不被情绪左右的技术选型**

| 维度 | Vue 3 (Nuxt) | React (Next.js/Hydrogen) | Atlas 决策逻辑 (Why We Chose Vue) |
| :--- | :--- | :--- | :--- |
| **心智模型** | 响应式可变 (Mutable) | 函数式不可变 (Immutable) | Builder 需要大量细粒度更新（如拖拽组件实时预览），Vue 的响应式系统 (Proxy) 在处理复杂状态同步时，代码更符合直觉，心智负担更低。 |
| **招聘成本** | 中 (容易上手) | 高 (Hook 陷阱多) | 团队现有成员都是 Vue 背景，转 React 隐性成本极高（useEffect 闭包陷阱、Re-render 优化都需要资深经验）。 |
| **生态适配** | 强 (Headless UI 等) | 极强 (Shopify 官方支持) | 虽然 Shopify 官方推 React (Hydrogen)，但通过 Storefront API，我们可以用 Vue 获得同样的灵活性，且不用被锁定在 Hydrogen 的特定架构中。 |
| **性能优化** | 自动依赖收集 | 需手动 Memoization | Vue 3 的性能下限更高，新手不容易写出巨慢的代码。React 需要大量 `useMemo`/`useCallback` 才能达到同等性能。 |

**架构师建议**：
*   **不要为了简历选型**：不要因为你想学 React 就强行在公司核心项目用 React，这是对公司的不负责任。
*   **用数据说话**：如果有人坚持换框架，让他出一个 POC (Proof of Concept) 并对比开发效率（例如：同样实现一个拖拽功能，谁的代码量更少，谁的 Bug 更少）。

## 5. 架构师的沟通艺术 (Communication Arts)
**技术再好，说不出去也是零**

*   **对老板说人话 (Business Language)**：
    *   ❌ "我们需要重构，因为现在的代码耦合度太高，违背了 SOLID 原则。" (老板听不懂)
    *   ✅ "我们需要两周整理代码，这样下次加新功能可以快 50%（提效），如果不做，下个版本可能会延期（风险）。"
*   **对开发说实话 (Honesty)**：
    *   承认技术债的存在，并承诺会还，不要忽悠说“先上线，以后肯定重写”。
    *   *话术*："我知道这个 `any` 写得很丑，但是为了赶明天的 Demo，我们先这样。我已经记在 Tech Debt Radar 里了，下周 Sprint 我们专门抽一天来修。"
*   **写文档的技巧**：
    *   **TL;DR**：在长文档开头永远放一个“太长不看”的摘要。
    *   **图表胜过文字**：能画流程图就别写 500 字的小作文。
